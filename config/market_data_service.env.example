# Market Data service environment configuration
# Generated from scripts/generate_market_data_env.py
#
# Copy this file to `.env.market_data` (或类似路径) 并根据部署环境调整变量。
# 服务会读取这些变量构建 FastAPI 应用、行情订阅参数与 IB 客户端。
# 参阅 docs/ib_service_client_template.md 与 docs/ib_connection_manager.md
# 获取 IB 连接的详细说明。

# FastAPI metadata
MARKET_DATA_APP_NAME="Market Data Service"
MARKET_DATA_APP_VERSION="0.1.0"
MARKET_DATA_APP_DEBUG=false
MARKET_DATA_DOCS_URL="/docs"
MARKET_DATA_REDOC_URL="/docs"
MARKET_DATA_OPENAPI_URL="/openapi.json"
MARKET_DATA_REQUEST_ID_HEADER="X-Request-ID"
MARKET_DATA_DEFAULT_TIMEFRAME="bar_1s"

# CORS configuration
MARKET_DATA_CORS_ENABLED=false
MARKET_DATA_CORS_ALLOW_ORIGINS=*
MARKET_DATA_CORS_ALLOW_METHODS=*
MARKET_DATA_CORS_ALLOW_HEADERS=*

# Redis publish/subscribe channels
MARKET_DATA_REDIS_CHANNEL_PREFIX=""
MARKET_DATA_REDIS_DOM_CHANNEL="market.dom"
MARKET_DATA_REDIS_TICKER_CHANNEL="market.ticker"
MARKET_DATA_REDIS_BAR_CHANNEL="market.bar"

# Subscription defaults
MARKET_DATA_DEFAULT_DEPTH_ROWS=10
MARKET_DATA_DOM_THROTTLE_SECONDS=0.0
MARKET_DATA_PRICE_THROTTLE_SECONDS=0.0
MARKET_DATA_BAR_THROTTLE_SECONDS=0.0
MARKET_DATA_AUTO_RESTART=true
MARKET_DATA_RESTART_DELAY_SECONDS=3.0
MARKET_DATA_DEFAULT_BAR_SIZE="1 min"
MARKET_DATA_DEFAULT_BAR_DURATION="1 D"
MARKET_DATA_DEFAULT_BAR_WHAT_TO_SHOW="TRADES"
MARKET_DATA_DEFAULT_BAR_USE_RTH=false
MARKET_DATA_DEFAULT_STOCK_EXCHANGE="SMART"
MARKET_DATA_DEFAULT_STOCK_CURRENCY="USD"
MARKET_DATA_DEFAULT_FOREX_EXCHANGE="IDEALPRO"
MARKET_DATA_DEFAULT_FOREX_CURRENCY="USD"
MARKET_DATA_DEFAULT_FUTURE_EXCHANGE="CME"
MARKET_DATA_DEFAULT_FUTURE_CURRENCY="USD"
MARKET_DATA_DEFAULT_INDEX_EXCHANGE="CBOE"
MARKET_DATA_DEFAULT_INDEX_CURRENCY="USD"

# Local persistence configuration
MARKET_DATA_PERSISTENCE_ENABLED=true
MARKET_DATA_PERSISTENCE_BASE_PATH="data/market-data"
MARKET_DATA_PERSISTENCE_BARS_SUBDIR=""
MARKET_DATA_PERSISTENCE_DOM_SUBDIR="dom"
MARKET_DATA_PERSISTENCE_FLUSH_INTERVAL_SECONDS=5.0
MARKET_DATA_PERSISTENCE_MAX_BATCH_SIZE=200
MARKET_DATA_PERSISTENCE_MAX_QUEUE_SIZE=1000

# Service discovery registration
MARKET_DATA_SERVICE_REGISTRY_ENABLED=true
MARKET_DATA_SERVICE_REGISTRY_NAME="market-data"
MARKET_DATA_SERVICE_REGISTRY_SCHEME="http"
MARKET_DATA_SERVICE_REGISTRY_HOST="127.0.0.1"
MARKET_DATA_SERVICE_REGISTRY_PORT=8102
MARKET_DATA_SERVICE_REGISTRY_URL=""
MARKET_DATA_SERVICE_REGISTRY_KEY="services:registry"
MARKET_DATA_SERVICE_REGISTRY_HEARTBEAT=30.0
MARKET_DATA_SERVICE_REGISTRY_REGISTRATION_ATTEMPTS=10
MARKET_DATA_SERVICE_REGISTRY_RESTART_MODE=""
MARKET_DATA_SERVICE_REGISTRY_DOCKER_CONTAINER=""
MARKET_DATA_SERVICE_REGISTRY_DOCKER_HOST=""

# Logging configuration
LOG_DIR=logs
LOG_LEVEL=INFO
LOG_STREAM=true

# Shared storage/configuration
DATA_DIR=data
REDIS_URL=redis://127.0.0.1:6379/0
MARKET_DATA_PATH=data/market-data

# IB Gateway connection (see docs/ib_connection_manager.md for details)
IB_GATEWAY_HOST=127.0.0.1
IB_GATEWAY_PORT=4002
IB_CLIENT_ID=20
IB_CONNECT_TIMEOUT=15.0
IB_READ_ONLY=false
IB_ACCOUNT=""
IB_MARKET_DATA_DEPTH_ROWS=10
IB_MARKET_DATA_QUEUE_SIZE=64