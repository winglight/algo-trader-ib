# Strategy service environment configuration
# Generated from scripts/generate_strategy_env.py
#
# Copy this file to `.env.strategy`（或类似路径）后根据部署环境调整。
# 服务会读取这些变量构建 FastAPI、Redis 推送与指标调度设置。

# FastAPI metadata
STRATEGY_APP_NAME="Strategy Service"
STRATEGY_APP_VERSION="0.1.0"
STRATEGY_APP_DEBUG=false
STRATEGY_DOCS_URL="/docs"
STRATEGY_REDOC_URL="/docs"
STRATEGY_OPENAPI_URL="/openapi.json"

# Request correlation
STRATEGY_REQUEST_ID_HEADER="X-Request-ID"

# CORS configuration
STRATEGY_CORS_ENABLED=false
STRATEGY_CORS_ALLOW_ORIGINS=*
STRATEGY_CORS_ALLOW_METHODS=*
STRATEGY_CORS_ALLOW_HEADERS=*

# Redis publish/subscribe channels
STRATEGY_STATUS_CHANNEL="strategy.status"
STRATEGY_METRICS_CHANNEL="strategy.metric"
STRATEGY_PUBLISH_STATUS_EVENTS=true
STRATEGY_PUBLISH_METRIC_EVENTS=true

# Metrics scheduling
STRATEGY_METRICS_REFRESH_INTERVAL=5.0
STRATEGY_PERFORMANCE_PERIODS="day,week,month,all"

# Strategy discovery
STRATEGY_SOURCE_DIR="src/strategies"
STRATEGY_PACKAGE="src.strategies"

# Market data REST integration
STRATEGY_MARKET_DATA_BASE_URL="http://127.0.0.1:8102"
STRATEGY_MARKET_DATA_SYMBOLS=""
STRATEGY_MARKET_DATA_DOM_THROTTLE_SECONDS=0.05
STRATEGY_MARKET_DATA_TICKER_THROTTLE_SECONDS=0.05
STRATEGY_MARKET_DATA_BAR_THROTTLE_SECONDS=1.0
STRATEGY_MARKET_DATA_DOM_REFRESH_SECONDS=5.0

# Market data retry behaviour
STRATEGY_MARKET_DATA_RETRY_INTERVAL=5.0

# Service registry & discovery
STRATEGY_SERVICE_REGISTRY_ENABLED=true
STRATEGY_SERVICE_REGISTRY_NAME="strategy"
STRATEGY_SERVICE_REGISTRY_SCHEME="http"
STRATEGY_SERVICE_REGISTRY_HOST="127.0.0.1"
STRATEGY_SERVICE_REGISTRY_PORT=8104
STRATEGY_SERVICE_REGISTRY_URL=""
STRATEGY_SERVICE_REGISTRY_KEY="services:registry"
STRATEGY_SERVICE_REGISTRY_HEARTBEAT=30.0
STRATEGY_SERVICE_REGISTRY_REGISTRATION_ATTEMPTS=10
STRATEGY_SERVICE_REGISTRY_RESTART_MODE=""
STRATEGY_SERVICE_REGISTRY_DOCKER_CONTAINER=""
STRATEGY_SERVICE_REGISTRY_DOCKER_HOST=""
STRATEGY_SERVICE_DISCOVERY_ENABLED=true
STRATEGY_SERVICE_DISCOVERY_REGISTRY_KEY="services:registry"
STRATEGY_ORDERS_BASE_URL="http://127.0.0.1:8101"
STRATEGY_ORDERS_SERVICE_NAME="orders"
# Orders event bridge defaults mirror the external Orders service Redis schema.
# Override when necessary, but do not leave the channel names blank.
STRATEGY_ORDERS_STATUS_CHANNEL="orders.status"
STRATEGY_ORDERS_FILL_CHANNEL="orders.fill"
STRATEGY_RISK_SERVICE_NAME="risk"
STRATEGY_MARKET_DATA_SERVICE_NAME="market-data"

# Logging configuration
LOG_DIR=logs
LOG_LEVEL=INFO
LOG_STREAM=true

# Shared directories
DATA_DIR=data

# Shared Redis connection
REDIS_URL=redis://127.0.0.1:6379/0

# IB Gateway connection (inherits overrides from the root `.env`)
IB_GATEWAY_HOST=127.0.0.1
IB_GATEWAY_PORT=4002
IB_CLIENT_ID=60
IB_CLIENT_ID_FALLBACKS=
IB_CONNECT_TIMEOUT=15.0
IB_READ_ONLY=false

# MariaDB connection (inherits values from the root `.env`)
MARIADB_URL=mariadb://app_user:change_me@127.0.0.1:3306/algo_trader
MARIADB_POOL_SIZE=5
MARIADB_MAX_OVERFLOW=10
MARIADB_POOL_RECYCLE=1800
MARIADB_ECHO=false

# Scanner defaults
STRATEGY_SCANNER_MAX_CHILDREN=3
STRATEGY_SCANNER_SCAN_CODE=TOP_PERC_GAIN
STRATEGY_SCANNER_LOCATION_CODE=STK.US.MAJOR
STRATEGY_SCANNER_INSTRUMENT=STK
STRATEGY_SCANNER_SELECTION_LIMIT=3
STRATEGY_SCANNER_METADATA_CACHE_PATH="~/.cache/algo-trader/scanner_metadata.json"